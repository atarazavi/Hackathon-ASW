---
phase: 01-setup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/app/__init__.py
  - backend/app/main.py
  - backend/app/config.py
  - backend/app/routers/__init__.py
  - backend/app/routers/review.py
  - backend/requirements.txt
  - backend/.env.example
  - backend/test_connection.py
  - docs/README.md
  - .gitignore
  - README.md
autonomous: true

must_haves:
  truths:
    - "Python backend runs locally on port 8000"
    - "Health endpoint returns 200 OK"
    - "Azure OpenAI connection can be verified with test script"
    - "Git repo has backend/ and docs/ folder structure"
  artifacts:
    - path: "backend/app/main.py"
      provides: "FastAPI app with CORS and health endpoint"
      contains: "CORSMiddleware"
    - path: "backend/app/config.py"
      provides: "Pydantic Settings for Azure OpenAI config"
      contains: "azure_openai_endpoint"
    - path: "backend/requirements.txt"
      provides: "Python dependencies"
      contains: "fastapi"
    - path: "backend/.env.example"
      provides: "Template for environment variables"
      contains: "AZURE_OPENAI"
  key_links:
    - from: "backend/app/main.py"
      to: "backend/app/config.py"
      via: "import Settings"
      pattern: "from .config import Settings"
---

<objective>
Create repository folder structure and Python backend scaffolding with Azure OpenAI configuration.

Purpose: Establish the backend foundation so full-stack developer can immediately start building the analysis agent in Phase 2A. This is setup for a 6-person hackathon team.

Output: Working FastAPI server that starts locally, health check endpoint, Azure OpenAI client configuration ready for credentials.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-setup/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create folder structure and root files</name>
  <files>
    - backend/app/__init__.py
    - backend/app/routers/__init__.py
    - docs/README.md
    - .gitignore
    - README.md
  </files>
  <action>
Create the monorepo folder structure:

1. Create directories:
   - `backend/app/routers/`
   - `docs/`

2. Create `backend/app/__init__.py` - empty file (package marker)

3. Create `backend/app/routers/__init__.py` - empty file (package marker)

4. Create `docs/README.md` with minimal content:
```markdown
# Documentation

Setup and usage documentation for the Design Review AI project.
```

5. Create `.gitignore` with:
```
# Python
__pycache__/
*.py[cod]
.venv/
venv/
.env

# Node
node_modules/
*.js
!plugin/code.js

# IDE
.idea/
.vscode/
*.swp

# OS
.DS_Store
```

6. Create root `README.md` with:
```markdown
# Frontend Design Reviewer

Figma plugin for AI-powered design review using Azure OpenAI.

## Structure

- `backend/` - Python FastAPI backend
- `plugin/` - Figma plugin
- `docs/` - Documentation

## Quick Start

See `docs/README.md` for setup instructions.
```
  </action>
  <verify>
Verify directories exist:
- `ls backend/app/routers/` shows `__init__.py`
- `ls docs/` shows `README.md`
- `ls .gitignore` exists
  </verify>
  <done>Folder structure exists with package markers and root documentation files</done>
</task>

<task type="auto">
  <name>Task 2: Create backend Python files</name>
  <files>
    - backend/app/main.py
    - backend/app/config.py
    - backend/app/routers/review.py
    - backend/requirements.txt
    - backend/.env.example
    - backend/test_connection.py
  </files>
  <action>
Create the FastAPI backend files following patterns from 01-RESEARCH.md:

1. Create `backend/app/config.py`:
```python
from pydantic_settings import BaseSettings, SettingsConfigDict

class Settings(BaseSettings):
    azure_openai_endpoint: str
    azure_openai_api_key: str
    azure_openai_deployment: str
    azure_openai_api_version: str = "2024-02-15-preview"

    model_config = SettingsConfigDict(env_file=".env", env_file_encoding="utf-8")
```

2. Create `backend/app/main.py`:
```python
from functools import lru_cache
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
from .config import Settings

app = FastAPI(title="Design Review API")

# CORS - required for Figma plugin (null origin)
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

@lru_cache
def get_settings():
    return Settings()

@app.get("/health")
async def health():
    return {"status": "ok"}
```

3. Create `backend/app/routers/review.py` - placeholder for Phase 2A:
```python
from fastapi import APIRouter

router = APIRouter(prefix="/review", tags=["review"])

# Review endpoints will be added in Phase 2A
```

4. Create `backend/requirements.txt`:
```
fastapi>=0.109.0
uvicorn>=0.27.0
openai>=1.12.0
pydantic-settings>=2.1.0
python-dotenv>=1.0.0
```

5. Create `backend/.env.example`:
```bash
# Azure OpenAI Configuration
# Get these values from Azure Portal > OpenAI resource
AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
AZURE_OPENAI_API_KEY=your-api-key-here
AZURE_OPENAI_DEPLOYMENT=your-deployment-name
AZURE_OPENAI_API_VERSION=2024-02-15-preview
```

6. Create `backend/test_connection.py`:
```python
"""Quick script to verify Azure OpenAI connection"""
import os
from dotenv import load_dotenv
from openai import AzureOpenAI

load_dotenv()

client = AzureOpenAI(
    api_version=os.environ.get("AZURE_OPENAI_API_VERSION", "2024-02-15-preview"),
    azure_endpoint=os.environ["AZURE_OPENAI_ENDPOINT"],
    api_key=os.environ["AZURE_OPENAI_API_KEY"],
)

try:
    completion = client.chat.completions.create(
        model=os.environ["AZURE_OPENAI_DEPLOYMENT"],
        messages=[{"role": "user", "content": "Say 'connection successful'"}],
        max_tokens=10,
    )
    print("SUCCESS:", completion.choices[0].message.content)
except Exception as e:
    print("FAILED:", str(e))
```
  </action>
  <verify>
Run these commands from project root:
1. `python -c "from backend.app.config import Settings; print('config ok')"`
2. `cd backend && pip install -r requirements.txt`
3. `cd backend && uvicorn app.main:app --port 8000` - server starts without error
4. `curl http://localhost:8000/health` - returns `{"status":"ok"}`
  </verify>
  <done>Backend server starts on port 8000, health endpoint returns 200 OK, test_connection.py exists for Azure OpenAI verification</done>
</task>

</tasks>

<verification>
Phase 1 backend requirements met:
1. `uvicorn app.main:app --port 8000` runs without error
2. `curl http://localhost:8000/health` returns `{"status":"ok"}`
3. `.env.example` documents required Azure OpenAI variables
4. `test_connection.py` ready for Azure OpenAI verification (requires user to add .env with credentials)
</verification>

<success_criteria>
- [ ] Folder structure exists: backend/app/routers/, docs/
- [ ] FastAPI server starts on port 8000 without errors
- [ ] GET /health returns {"status": "ok"}
- [ ] requirements.txt includes all dependencies (fastapi, uvicorn, openai, pydantic-settings, python-dotenv)
- [ ] .env.example documents Azure OpenAI configuration
- [ ] test_connection.py exists for manual Azure verification
</success_criteria>

<output>
After completion, create `.planning/phases/01-setup/01-01-SUMMARY.md`
</output>
